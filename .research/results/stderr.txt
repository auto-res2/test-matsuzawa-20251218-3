Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 237ms
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading numpy (16.1MiB)
Downloading pandas (12.2MiB)
Downloading pillow (6.7MiB)
Downloading grpcio (6.3MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading sympy (6.0MiB)
Downloading fonttools (4.8MiB)
Downloading sqlalchemy (3.2MiB)
Downloading networkx (2.0MiB)
Downloading pydantic-core (2.0MiB)
Downloading kiwisolver (1.4MiB)
Downloading setuptools (1.1MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading tensorboard (5.3MiB)
Downloading scikit-learn (8.7MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
Downloading scipy (34.2MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading torchvision (7.7MiB)
Downloading triton (162.5MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading torch (858.1MiB)
Downloading wandb (21.8MiB)
Downloading matplotlib (8.3MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
 Downloaded sqlalchemy
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded setuptools
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded matplotlib
 Downloaded scikit-learn
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded sympy
 Downloaded numpy
 Downloaded pandas
 Downloaded scipy
 Downloaded wandb
 Downloaded nvidia-nvjitlink-cu12
 Downloaded nvidia-curand-cu12
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded triton
 Downloaded nvidia-cufft-cu12
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 33.30s
Installed 81 packages in 285ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
2025-12-18 11:04:12,699 - __main__ - INFO - Trainer initialized on device: cpu
2025-12-18 11:04:12,699 - __main__ - INFO - ================================================================================
2025-12-18 11:04:12,699 - __main__ - INFO - STARTING TRAINING
2025-12-18 11:04:12,699 - __main__ - INFO - ================================================================================
2025-12-18 11:04:12,699 - __main__ - INFO - Building model: ResNet-20
2025-12-18 11:04:12,708 - __main__ - INFO - Model parameters - Total: 272,474, Trainable: 272,474
2025-12-18 11:04:12,716 - __main__ - INFO - ✓ Model output shape verified: torch.Size([2, 10])
2025-12-18 11:04:12,716 - __main__ - INFO - Loading dataset: CIFAR-10
  0%|          | 0.00/170M [00:00<?, ?B/s]  0%|          | 32.8k/170M [00:00<09:41, 293kB/s]  0%|          | 229k/170M [00:00<02:32, 1.11MB/s]  0%|          | 852k/170M [00:00<00:54, 3.09MB/s]  2%|▏         | 3.47M/170M [00:00<00:15, 10.9MB/s]  6%|▌         | 9.50M/170M [00:00<00:06, 25.4MB/s]  9%|▉         | 15.8M/170M [00:00<00:04, 34.3MB/s] 13%|█▎        | 22.1M/170M [00:00<00:03, 39.8MB/s] 17%|█▋        | 28.2M/170M [00:00<00:03, 43.0MB/s] 20%|██        | 34.2M/170M [00:01<00:02, 47.6MB/s] 23%|██▎       | 39.0M/170M [00:01<00:02, 47.5MB/s] 26%|██▌       | 44.2M/170M [00:01<00:02, 47.4MB/s] 29%|██▉       | 49.6M/170M [00:01<00:02, 49.3MB/s] 32%|███▏      | 54.8M/170M [00:01<00:02, 49.8MB/s] 35%|███▌      | 59.8M/170M [00:01<00:02, 48.9MB/s] 38%|███▊      | 65.6M/170M [00:01<00:02, 51.4MB/s] 41%|████▏     | 70.7M/170M [00:01<00:01, 50.9MB/s] 44%|████▍     | 75.9M/170M [00:01<00:01, 49.1MB/s] 47%|████▋     | 80.9M/170M [00:01<00:01, 49.3MB/s] 50%|█████     | 85.9M/170M [00:02<00:01, 43.7MB/s] 53%|█████▎    | 90.3M/170M [00:02<00:02, 36.8MB/s] 55%|█████▌    | 94.3M/170M [00:02<00:02, 34.8MB/s] 57%|█████▋    | 97.9M/170M [00:02<00:02, 32.6MB/s] 59%|█████▉    | 101M/170M [00:02<00:02, 30.7MB/s]  61%|██████▏   | 105M/170M [00:02<00:02, 31.7MB/s] 63%|██████▎   | 108M/170M [00:02<00:01, 31.8MB/s] 65%|██████▌   | 111M/170M [00:03<00:01, 31.3MB/s] 67%|██████▋   | 115M/170M [00:03<00:01, 30.5MB/s] 69%|██████▉   | 118M/170M [00:03<00:01, 29.2MB/s] 71%|███████   | 121M/170M [00:03<00:01, 29.5MB/s] 73%|███████▎  | 124M/170M [00:03<00:01, 30.2MB/s] 74%|███████▍  | 127M/170M [00:03<00:01, 29.6MB/s] 76%|███████▌  | 130M/170M [00:03<00:01, 29.6MB/s] 78%|███████▊  | 133M/170M [00:03<00:01, 28.7MB/s] 80%|███████▉  | 136M/170M [00:03<00:01, 28.4MB/s] 81%|████████▏ | 139M/170M [00:03<00:01, 28.4MB/s] 83%|████████▎ | 141M/170M [00:04<00:01, 28.2MB/s] 85%|████████▍ | 144M/170M [00:04<00:00, 27.2MB/s] 86%|████████▋ | 147M/170M [00:04<00:00, 25.7MB/s] 88%|████████▊ | 150M/170M [00:04<00:00, 25.9MB/s] 89%|████████▉ | 153M/170M [00:04<00:00, 25.1MB/s] 91%|█████████ | 155M/170M [00:04<00:00, 24.6MB/s] 92%|█████████▏| 158M/170M [00:04<00:00, 23.2MB/s] 94%|█████████▍| 160M/170M [00:04<00:00, 21.8MB/s] 95%|█████████▌| 162M/170M [00:04<00:00, 21.4MB/s] 96%|█████████▋| 164M/170M [00:05<00:00, 21.4MB/s] 98%|█████████▊| 166M/170M [00:05<00:00, 20.5MB/s] 99%|█████████▉| 169M/170M [00:05<00:00, 20.5MB/s]100%|██████████| 170M/170M [00:05<00:00, 31.6MB/s]
2025-12-18 11:04:21,643 - __main__ - INFO - Train samples: 45000, Val samples: 5000, Test samples: 10000
2025-12-18 11:04:21,643 - __main__ - INFO - Train batches per epoch: 351
2025-12-18 11:04:21,644 - __main__ - INFO - ✓ Normalization stats validated - Mean: [0.4914 0.4822 0.4465], Std: [0.2023 0.1994 0.201 ]
2025-12-18 11:04:21,644 - __main__ - INFO - Building optimizer: adam
2025-12-18 11:04:21,645 - __main__ - INFO - ✓ Optimizer initialized with lr=1.00e-03
2025-12-18 11:04:21,645 - __main__ - INFO - Learning rate scheduler: cosine (warmup_steps=500, total_steps=351)
2025-12-18 11:04:21,645 - __main__ - INFO - WandB disabled (trial mode or mode=disabled)
2025-12-18 11:04:21,645 - __main__ - INFO - 
================================================================================
2025-12-18 11:04:21,645 - __main__ - INFO - Epoch 1/1
2025-12-18 11:04:21,645 - __main__ - INFO - ================================================================================
2025-12-18 11:04:21,794 - __main__ - INFO - ✓ Batch shapes verified - Images: torch.Size([128, 3, 32, 32]), Labels: torch.Size([128])
2025-12-18 11:04:24,491 - __main__ - INFO - Step 0: epoch=1.0000, train_loss=5.9232, train_throughput_samples_per_sec=240.3614, val_accuracy=10.5469, val_loss=7.5216, test_accuracy=11.3281, test_loss=7.8562, learning_rate=0.0000
2025-12-18 11:04:24,492 - __main__ - INFO - ✓ New best validation accuracy: 10.55% at epoch 1
2025-12-18 11:04:24,492 - __main__ - INFO - 
================================================================================
2025-12-18 11:04:24,492 - __main__ - INFO - TRAINING COMPLETE - FINAL EVALUATION
2025-12-18 11:04:24,492 - __main__ - INFO - ================================================================================
2025-12-18 11:04:25,379 - __main__ - INFO - Final Test Accuracy: 11.33%
2025-12-18 11:04:25,380 - __main__ - INFO - Final Test Loss: 7.8562
2025-12-18 11:04:25,380 - __main__ - INFO - Best Validation Accuracy: 10.55% (epoch 1)
2025-12-18 11:04:25,380 - __main__ - INFO - Total training time: 12.68 seconds
2025-12-18 11:04:25,380 - __main__ - INFO - Training complete. Best validation accuracy: 10.55%
Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 440ms
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading numpy (16.1MiB)
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading sqlalchemy (3.2MiB)
Downloading networkx (2.0MiB)
Downloading pydantic-core (2.0MiB)
Downloading kiwisolver (1.4MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
Downloading setuptools (1.1MiB)
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading scipy (34.2MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading fonttools (4.8MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading grpcio (6.3MiB)
Downloading pillow (6.7MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
Downloading sympy (6.0MiB)
Downloading pandas (12.2MiB)
Downloading tensorboard (5.3MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading scikit-learn (8.7MiB)
Downloading matplotlib (8.3MiB)
Downloading triton (162.5MiB)
Downloading torch (858.1MiB)
Downloading wandb (21.8MiB)
Downloading torchvision (7.7MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
 Downloaded sqlalchemy
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded setuptools
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded matplotlib
 Downloaded scikit-learn
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded sympy
 Downloaded numpy
 Downloaded pandas
 Downloaded nvidia-nvjitlink-cu12
 Downloaded scipy
 Downloaded wandb
 Downloaded nvidia-curand-cu12
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded triton
 Downloaded nvidia-cufft-cu12
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 38.60s
Installed 81 packages in 279ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
Error executing job with overrides: ['run=proposed-resnet20-cifar10', 'results_dir=.research/results', 'mode=trial']
Traceback (most recent call last):
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/main.py", line 74, in main
    cfg_merged = OmegaConf.merge(cfg, OmegaConf.create(run_config_dict))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
omegaconf.errors.ConfigKeyError: Key 'alpha_reweight' is not in struct
    full_key: training.optimizer_config.alpha_reweight
    object_type=dict

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 826ms
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading scipy (34.2MiB)
Downloading wandb (21.8MiB)
Downloading numpy (16.1MiB)
Downloading pandas (12.2MiB)
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading scikit-learn (8.7MiB)
Downloading matplotlib (8.3MiB)
Downloading torchvision (7.7MiB)
Downloading pillow (6.7MiB)
Downloading grpcio (6.3MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading sympy (6.0MiB)
Downloading tensorboard (5.3MiB)
Downloading fonttools (4.8MiB)
Downloading sqlalchemy (3.2MiB)
Downloading networkx (2.0MiB)
Downloading pydantic-core (2.0MiB)
Downloading kiwisolver (1.4MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading setuptools (1.1MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
Downloading triton (162.5MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading torch (858.1MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded sqlalchemy
 Downloaded setuptools
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded matplotlib
 Downloaded scikit-learn
 Downloaded sympy
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded numpy
 Downloaded pandas
 Downloaded wandb
 Downloaded scipy
 Downloaded nvidia-nvjitlink-cu12
 Downloaded nvidia-curand-cu12
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded triton
 Downloaded nvidia-cufft-cu12
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 1m 19s
Installed 81 packages in 296ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
2025-12-18 11:09:48,470 - __main__ - INFO - Trainer initialized on device: cpu
2025-12-18 11:09:48,470 - __main__ - INFO - ================================================================================
2025-12-18 11:09:48,470 - __main__ - INFO - STARTING TRAINING
2025-12-18 11:09:48,471 - __main__ - INFO - ================================================================================
2025-12-18 11:09:48,471 - __main__ - INFO - Building model: ResNet-20
2025-12-18 11:09:48,479 - __main__ - INFO - Model parameters - Total: 272,474, Trainable: 272,474
2025-12-18 11:09:48,488 - __main__ - INFO - ✓ Model output shape verified: torch.Size([2, 10])
2025-12-18 11:09:48,489 - __main__ - INFO - Loading dataset: CIFAR-10
  0%|          | 0.00/170M [00:00<?, ?B/s]  1%|          | 1.67M/170M [00:00<00:10, 16.6MB/s]  5%|▌         | 8.88M/170M [00:00<00:03, 49.1MB/s]  9%|▉         | 15.8M/170M [00:00<00:02, 58.4MB/s] 13%|█▎        | 22.5M/170M [00:00<00:02, 61.2MB/s] 17%|█▋        | 28.7M/170M [00:00<00:02, 61.5MB/s] 21%|██        | 35.6M/170M [00:00<00:02, 63.9MB/s] 25%|██▍       | 42.4M/170M [00:00<00:01, 65.1MB/s] 29%|██▉       | 49.7M/170M [00:00<00:01, 67.5MB/s] 33%|███▎      | 56.7M/170M [00:00<00:01, 68.0MB/s] 37%|███▋      | 63.5M/170M [00:01<00:01, 66.4MB/s] 41%|████▏     | 70.5M/170M [00:01<00:01, 67.5MB/s] 45%|████▌     | 77.3M/170M [00:01<00:01, 67.1MB/s] 49%|████▉     | 84.1M/170M [00:01<00:01, 67.3MB/s] 53%|█████▎    | 91.2M/170M [00:01<00:01, 68.2MB/s] 58%|█████▊    | 98.0M/170M [00:01<00:01, 68.2MB/s] 62%|██████▏   | 105M/170M [00:01<00:00, 67.1MB/s]  65%|██████▌   | 112M/170M [00:01<00:00, 63.5MB/s] 70%|██████▉   | 119M/170M [00:01<00:00, 66.2MB/s] 74%|███████▎  | 126M/170M [00:01<00:00, 65.5MB/s] 78%|███████▊  | 133M/170M [00:02<00:00, 68.5MB/s] 82%|████████▏ | 140M/170M [00:02<00:00, 69.7MB/s] 87%|████████▋ | 148M/170M [00:02<00:00, 71.7MB/s] 91%|█████████▏| 156M/170M [00:02<00:00, 73.1MB/s] 96%|█████████▌| 164M/170M [00:02<00:00, 74.3MB/s]100%|██████████| 170M/170M [00:02<00:00, 67.1MB/s]
2025-12-18 11:09:53,653 - __main__ - INFO - Train samples: 45000, Val samples: 5000, Test samples: 10000
2025-12-18 11:09:53,653 - __main__ - INFO - Train batches per epoch: 351
2025-12-18 11:09:53,655 - __main__ - INFO - ✓ Normalization stats validated - Mean: [0.4914 0.4822 0.4465], Std: [0.2023 0.1994 0.201 ]
2025-12-18 11:09:53,655 - __main__ - INFO - Building optimizer: CurvAL
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 660, in <module>
    best_val = trainer.train()
               ^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 523, in train
    self._build_optimizer(trial_params)
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 261, in _build_optimizer
    raise ImportError(
ImportError: CurvAL optimizer is not available. Please ensure src/optimizer.py exists and contains the CurvAL class.
Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 244ms
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading networkx (2.0MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading pandas (12.2MiB)
Downloading sqlalchemy (3.2MiB)
Downloading scipy (34.2MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading setuptools (1.1MiB)
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading sympy (6.0MiB)
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading pydantic-core (2.0MiB)
Downloading grpcio (6.3MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
Downloading pillow (6.7MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading fonttools (4.8MiB)
Downloading numpy (16.1MiB)
Downloading matplotlib (8.3MiB)
Downloading kiwisolver (1.4MiB)
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading wandb (21.8MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading scikit-learn (8.7MiB)
Downloading tensorboard (5.3MiB)
Downloading torch (858.1MiB)
Downloading triton (162.5MiB)
Downloading torchvision (7.7MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
 Downloaded sqlalchemy
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded setuptools
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded matplotlib
 Downloaded scikit-learn
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded sympy
 Downloaded numpy
 Downloaded pandas
 Downloaded nvidia-nvjitlink-cu12
 Downloaded scipy
 Downloaded nvidia-curand-cu12
 Downloaded wandb
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded nvidia-cufft-cu12
 Downloaded triton
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 32.26s
Installed 81 packages in 297ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
2025-12-18 11:12:24,271 - __main__ - INFO - Trainer initialized on device: cpu
2025-12-18 11:12:24,271 - __main__ - INFO - ================================================================================
2025-12-18 11:12:24,271 - __main__ - INFO - STARTING TRAINING
2025-12-18 11:12:24,271 - __main__ - INFO - ================================================================================
2025-12-18 11:12:24,271 - __main__ - INFO - Building model: ResNet-20
2025-12-18 11:12:24,280 - __main__ - INFO - Model parameters - Total: 272,474, Trainable: 272,474
2025-12-18 11:12:24,288 - __main__ - INFO - ✓ Model output shape verified: torch.Size([2, 10])
2025-12-18 11:12:24,288 - __main__ - INFO - Loading dataset: CIFAR-10
  0%|          | 0.00/170M [00:00<?, ?B/s]  1%|▏         | 2.42M/170M [00:00<00:06, 24.2MB/s]  7%|▋         | 11.7M/170M [00:00<00:02, 64.2MB/s] 13%|█▎        | 21.3M/170M [00:00<00:01, 78.8MB/s] 18%|█▊        | 30.5M/170M [00:00<00:01, 83.8MB/s] 23%|██▎       | 39.3M/170M [00:00<00:01, 85.2MB/s] 28%|██▊       | 48.3M/170M [00:00<00:01, 86.7MB/s] 34%|███▎      | 57.2M/170M [00:00<00:01, 87.6MB/s] 39%|███▊      | 66.0M/170M [00:00<00:01, 82.9MB/s] 44%|████▎     | 74.4M/170M [00:00<00:01, 76.3MB/s] 48%|████▊     | 82.1M/170M [00:01<00:01, 72.7MB/s] 53%|█████▎    | 89.5M/170M [00:01<00:01, 67.8MB/s] 57%|█████▋    | 96.4M/170M [00:01<00:01, 63.1MB/s] 60%|██████    | 103M/170M [00:01<00:01, 58.7MB/s]  64%|██████▍   | 109M/170M [00:01<00:01, 53.6MB/s] 67%|██████▋   | 114M/170M [00:01<00:01, 48.1MB/s] 70%|██████▉   | 119M/170M [00:01<00:01, 46.0MB/s] 73%|███████▎  | 124M/170M [00:01<00:01, 43.7MB/s] 75%|███████▌  | 128M/170M [00:02<00:00, 42.5MB/s] 78%|███████▊  | 133M/170M [00:02<00:00, 41.0MB/s] 80%|████████  | 137M/170M [00:02<00:00, 39.7MB/s] 83%|████████▎ | 141M/170M [00:02<00:00, 40.1MB/s] 85%|████████▌ | 145M/170M [00:02<00:00, 40.2MB/s] 87%|████████▋ | 149M/170M [00:02<00:00, 39.1MB/s] 90%|████████▉ | 153M/170M [00:02<00:00, 39.5MB/s] 92%|█████████▏| 157M/170M [00:02<00:00, 38.7MB/s] 94%|█████████▍| 161M/170M [00:02<00:00, 38.4MB/s] 97%|█████████▋| 165M/170M [00:03<00:00, 38.9MB/s] 99%|█████████▉| 169M/170M [00:03<00:00, 38.2MB/s]100%|██████████| 170M/170M [00:03<00:00, 53.2MB/s]
2025-12-18 11:12:30,318 - __main__ - INFO - Train samples: 45000, Val samples: 5000, Test samples: 10000
2025-12-18 11:12:30,318 - __main__ - INFO - Train batches per epoch: 351
2025-12-18 11:12:30,319 - __main__ - INFO - ✓ Normalization stats validated - Mean: [0.4914 0.4822 0.4465], Std: [0.2023 0.1994 0.201 ]
2025-12-18 11:12:30,320 - __main__ - INFO - Building optimizer: CurvAL
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 660, in <module>
    best_val = trainer.train()
               ^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 523, in train
    self._build_optimizer(trial_params)
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 261, in _build_optimizer
    raise ImportError(
ImportError: CurvAL optimizer is not available. Please ensure src/optimizer.py exists and contains the CurvAL class.
Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 1.04s
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading pydantic-core (2.0MiB)
Downloading setuptools (1.1MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading matplotlib (8.3MiB)
Downloading sqlalchemy (3.2MiB)
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading networkx (2.0MiB)
Downloading numpy (16.1MiB)
Downloading sympy (6.0MiB)
Downloading pillow (6.7MiB)
Downloading grpcio (6.3MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading wandb (21.8MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading pandas (12.2MiB)
Downloading scipy (34.2MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading tensorboard (5.3MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading torchvision (7.7MiB)
Downloading torch (858.1MiB)
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
Downloading fonttools (4.8MiB)
Downloading kiwisolver (1.4MiB)
Downloading triton (162.5MiB)
Downloading scikit-learn (8.7MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
 Downloaded setuptools
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded sqlalchemy
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded sympy
 Downloaded matplotlib
 Downloaded scikit-learn
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded pandas
 Downloaded numpy
 Downloaded wandb
 Downloaded scipy
 Downloaded nvidia-nvjitlink-cu12
 Downloaded nvidia-curand-cu12
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded triton
 Downloaded nvidia-cufft-cu12
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 32.18s
Installed 81 packages in 191ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
2025-12-18 11:15:04,196 - __main__ - INFO - Trainer initialized on device: cpu
2025-12-18 11:15:04,196 - __main__ - INFO - ================================================================================
2025-12-18 11:15:04,196 - __main__ - INFO - STARTING TRAINING
2025-12-18 11:15:04,197 - __main__ - INFO - ================================================================================
2025-12-18 11:15:04,197 - __main__ - INFO - Building model: ResNet-20
2025-12-18 11:15:04,204 - __main__ - INFO - Model parameters - Total: 272,474, Trainable: 272,474
2025-12-18 11:15:04,217 - __main__ - INFO - ✓ Model output shape verified: torch.Size([2, 10])
2025-12-18 11:15:04,218 - __main__ - INFO - Loading dataset: CIFAR-10
  0%|          | 0.00/170M [00:00<?, ?B/s]  0%|          | 98.3k/170M [00:00<03:23, 838kB/s]  1%|          | 885k/170M [00:00<00:40, 4.20MB/s]  3%|▎         | 5.14M/170M [00:00<00:08, 20.0MB/s]  7%|▋         | 11.8M/170M [00:00<00:04, 37.1MB/s] 11%|█         | 18.2M/170M [00:00<00:03, 46.2MB/s] 15%|█▍        | 24.9M/170M [00:00<00:02, 51.6MB/s] 18%|█▊        | 31.4M/170M [00:00<00:02, 55.7MB/s] 23%|██▎       | 38.6M/170M [00:00<00:02, 60.7MB/s] 26%|██▋       | 45.1M/170M [00:00<00:02, 61.8MB/s] 30%|███       | 51.9M/170M [00:01<00:01, 63.7MB/s] 34%|███▍      | 58.7M/170M [00:01<00:01, 62.5MB/s] 39%|███▊      | 65.7M/170M [00:01<00:01, 64.8MB/s] 43%|████▎     | 72.7M/170M [00:01<00:01, 66.1MB/s] 47%|████▋     | 79.3M/170M [00:01<00:01, 65.3MB/s] 51%|█████     | 86.7M/170M [00:01<00:01, 67.8MB/s] 55%|█████▍    | 93.6M/170M [00:01<00:01, 65.4MB/s] 59%|█████▉    | 101M/170M [00:01<00:01, 67.1MB/s]  63%|██████▎   | 107M/170M [00:01<00:00, 65.2MB/s] 67%|██████▋   | 114M/170M [00:01<00:00, 65.8MB/s] 71%|███████   | 121M/170M [00:02<00:00, 64.0MB/s] 75%|███████▍  | 127M/170M [00:02<00:00, 60.7MB/s] 78%|███████▊  | 133M/170M [00:02<00:00, 60.9MB/s] 82%|████████▏ | 140M/170M [00:02<00:00, 56.7MB/s] 85%|████████▌ | 146M/170M [00:02<00:00, 57.6MB/s] 89%|████████▉ | 151M/170M [00:02<00:00, 51.9MB/s] 92%|█████████▏| 157M/170M [00:02<00:00, 48.4MB/s] 95%|█████████▍| 162M/170M [00:02<00:00, 48.6MB/s] 98%|█████████▊| 167M/170M [00:03<00:00, 49.5MB/s]100%|██████████| 170M/170M [00:03<00:00, 55.2MB/s]
2025-12-18 11:15:10,800 - __main__ - INFO - Train samples: 45000, Val samples: 5000, Test samples: 10000
2025-12-18 11:15:10,800 - __main__ - INFO - Train batches per epoch: 351
2025-12-18 11:15:10,801 - __main__ - INFO - ✓ Normalization stats validated - Mean: [0.4914 0.4822 0.4465], Std: [0.2023 0.1994 0.201 ]
2025-12-18 11:15:10,802 - __main__ - INFO - Building optimizer: adam
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 660, in <module>
    best_val = trainer.train()
               ^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 523, in train
    self._build_optimizer(trial_params)
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 252, in _build_optimizer
    opt_cfg = dict(self.cfg.training.optimizer_config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/dictconfig.py", line 375, in __getitem__
    self._format_and_raise(key=key, value=None, cause=e)
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/base.py", line 231, in _format_and_raise
    format_and_raise(
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/_utils.py", line 899, in format_and_raise
    _raise(ex, cause)
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/_utils.py", line 797, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set env var OC_CAUSE=1 for full trace
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/dictconfig.py", line 369, in __getitem__
    return self._get_impl(key=key, default_value=_DEFAULT_MARKER_)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/dictconfig.py", line 451, in _get_impl
    return self._resolve_with_default(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/omegaconf/basecontainer.py", line 96, in _resolve_with_default
    raise MissingMandatoryValue("Missing mandatory value: $FULL_KEY")
omegaconf.errors.MissingMandatoryValue: Missing mandatory value: training.optimizer_config.alpha_reweight
    full_key: training.optimizer_config.alpha_reweight
    object_type=dict
Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 712ms
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading scipy (34.2MiB)
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading matplotlib (8.3MiB)
Downloading torchvision (7.7MiB)
Downloading pillow (6.7MiB)
Downloading grpcio (6.3MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading tensorboard (5.3MiB)
Downloading fonttools (4.8MiB)
Downloading sqlalchemy (3.2MiB)
Downloading networkx (2.0MiB)
Downloading pydantic-core (2.0MiB)
Downloading kiwisolver (1.4MiB)
Downloading setuptools (1.1MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading triton (162.5MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading torch (858.1MiB)
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
Downloading scikit-learn (8.7MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading pandas (12.2MiB)
Downloading numpy (16.1MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading wandb (21.8MiB)
Downloading sympy (6.0MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded setuptools
 Downloaded sqlalchemy
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded matplotlib
 Downloaded sympy
 Downloaded scikit-learn
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded numpy
 Downloaded pandas
 Downloaded wandb
 Downloaded scipy
 Downloaded nvidia-nvjitlink-cu12
 Downloaded nvidia-curand-cu12
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded triton
 Downloaded nvidia-cufft-cu12
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 37.83s
Installed 81 packages in 436ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
2025-12-18 11:17:36,938 - __main__ - INFO - Trainer initialized on device: cpu
2025-12-18 11:17:36,938 - __main__ - INFO - ================================================================================
2025-12-18 11:17:36,939 - __main__ - INFO - STARTING TRAINING
2025-12-18 11:17:36,939 - __main__ - INFO - ================================================================================
2025-12-18 11:17:36,939 - __main__ - INFO - Building model: ResNet-20
2025-12-18 11:17:36,947 - __main__ - INFO - Model parameters - Total: 272,474, Trainable: 272,474
2025-12-18 11:17:36,957 - __main__ - INFO - ✓ Model output shape verified: torch.Size([2, 10])
2025-12-18 11:17:36,957 - __main__ - INFO - Loading dataset: CIFAR-10
  0%|          | 0.00/170M [00:00<?, ?B/s]  1%|▏         | 2.42M/170M [00:00<00:06, 24.2MB/s]  8%|▊         | 13.9M/170M [00:00<00:02, 77.5MB/s] 15%|█▍        | 25.4M/170M [00:00<00:01, 94.1MB/s] 22%|██▏       | 36.9M/170M [00:00<00:01, 102MB/s]  28%|██▊       | 48.4M/170M [00:00<00:01, 107MB/s] 35%|███▌      | 59.7M/170M [00:00<00:01, 109MB/s] 42%|████▏     | 71.3M/170M [00:00<00:00, 111MB/s] 49%|████▊     | 82.7M/170M [00:00<00:00, 112MB/s] 55%|█████▌    | 94.2M/170M [00:00<00:00, 113MB/s] 62%|██████▏   | 106M/170M [00:01<00:00, 114MB/s]  69%|██████▊   | 117M/170M [00:01<00:00, 114MB/s] 75%|███████▌  | 129M/170M [00:01<00:00, 114MB/s] 82%|████████▏ | 140M/170M [00:01<00:00, 114MB/s] 89%|████████▉ | 152M/170M [00:01<00:00, 114MB/s] 96%|█████████▌| 163M/170M [00:01<00:00, 114MB/s]100%|██████████| 170M/170M [00:01<00:00, 109MB/s]
2025-12-18 11:17:41,170 - __main__ - INFO - Train samples: 45000, Val samples: 5000, Test samples: 10000
2025-12-18 11:17:41,170 - __main__ - INFO - Train batches per epoch: 351
2025-12-18 11:17:41,171 - __main__ - INFO - ✓ Normalization stats validated - Mean: [0.4914 0.4822 0.4465], Std: [0.2023 0.1994 0.201 ]
2025-12-18 11:17:41,171 - __main__ - INFO - Building optimizer: adam
2025-12-18 11:17:41,172 - __main__ - INFO - ✓ Optimizer initialized with lr=1.00e-03
2025-12-18 11:17:41,172 - __main__ - INFO - Learning rate scheduler: cosine (warmup_steps=500, total_steps=351)
2025-12-18 11:17:41,172 - __main__ - INFO - WandB disabled (trial mode or mode=disabled)
2025-12-18 11:17:41,172 - __main__ - INFO - 
================================================================================
2025-12-18 11:17:41,172 - __main__ - INFO - Epoch 1/1
2025-12-18 11:17:41,172 - __main__ - INFO - ================================================================================
2025-12-18 11:17:41,326 - __main__ - INFO - ✓ Batch shapes verified - Images: torch.Size([128, 3, 32, 32]), Labels: torch.Size([128])
2025-12-18 11:17:43,925 - __main__ - INFO - Step 0: epoch=1.0000, train_loss=5.9232, train_throughput_samples_per_sec=227.1304, val_accuracy=10.5469, val_loss=7.5216, test_accuracy=11.3281, test_loss=7.8562, learning_rate=0.0000
2025-12-18 11:17:43,926 - __main__ - INFO - ✓ New best validation accuracy: 10.55% at epoch 1
2025-12-18 11:17:43,926 - __main__ - INFO - 
================================================================================
2025-12-18 11:17:43,926 - __main__ - INFO - TRAINING COMPLETE - FINAL EVALUATION
2025-12-18 11:17:43,926 - __main__ - INFO - ================================================================================
2025-12-18 11:17:44,788 - __main__ - INFO - Final Test Accuracy: 11.33%
2025-12-18 11:17:44,788 - __main__ - INFO - Final Test Loss: 7.8562
2025-12-18 11:17:44,788 - __main__ - INFO - Best Validation Accuracy: 10.55% (epoch 1)
2025-12-18 11:17:44,788 - __main__ - INFO - Total training time: 7.85 seconds
2025-12-18 11:17:44,788 - __main__ - INFO - Training complete. Best validation accuracy: 10.55%
Downloading cpython-3.11.14-linux-x86_64-gnu (download) (29.1MiB)
 Downloaded cpython-3.11.14-linux-x86_64-gnu (download)
Using CPython 3.11.14
Creating virtual environment at: .venv
Resolved 126 packages in 242ms
   Building curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
Downloading nvidia-cusolver-cu12 (255.1MiB)
Downloading nvidia-cuda-nvrtc-cu12 (84.0MiB)
Downloading nvidia-curand-cu12 (60.7MiB)
Downloading nvidia-nvjitlink-cu12 (37.4MiB)
Downloading scipy (34.2MiB)
Downloading numpy (16.1MiB)
Downloading pandas (12.2MiB)
Downloading kiwisolver (1.4MiB)
Downloading pillow (6.7MiB)
Downloading grpcio (6.3MiB)
Downloading tensorboard (5.3MiB)
Downloading setuptools (1.1MiB)
Downloading networkx (2.0MiB)
Downloading triton (162.5MiB)
Downloading matplotlib (8.3MiB)
Downloading sqlalchemy (3.2MiB)
Downloading pydantic-core (2.0MiB)
Downloading wandb (21.8MiB)
Downloading fonttools (4.8MiB)
Downloading nvidia-cusparse-cu12 (274.9MiB)
Downloading scikit-learn (8.7MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading nvidia-cusparselt-cu12 (273.9MiB)
Downloading nvidia-cuda-cupti-cu12 (9.8MiB)
Downloading nvidia-cufile-cu12 (1.1MiB)
Downloading nvidia-cufft-cu12 (184.2MiB)
Downloading nvidia-cublas-cu12 (566.8MiB)
Downloading nvidia-nvshmem-cu12 (118.9MiB)
Downloading sympy (6.0MiB)
Downloading nvidia-nccl-cu12 (307.4MiB)
Downloading nvidia-cudnn-cu12 (674.0MiB)
Downloading torch (858.1MiB)
Downloading torchvision (7.7MiB)
 Downloaded nvidia-cufile-cu12
 Downloaded kiwisolver
 Downloaded pydantic-core
      Built curval-research @ file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3
 Downloaded sqlalchemy
 Downloaded setuptools
 Downloaded networkx
 Downloaded fonttools
 Downloaded tensorboard
 Downloaded tensorboard-data-server
 Downloaded grpcio
 Downloaded pillow
 Downloaded torchvision
 Downloaded matplotlib
 Downloaded scikit-learn
 Downloaded nvidia-cuda-cupti-cu12
 Downloaded sympy
 Downloaded numpy
 Downloaded pandas
 Downloaded nvidia-nvjitlink-cu12
 Downloaded scipy
 Downloaded nvidia-curand-cu12
 Downloaded wandb
 Downloaded nvidia-cuda-nvrtc-cu12
 Downloaded nvidia-nvshmem-cu12
 Downloaded nvidia-cufft-cu12
 Downloaded triton
 Downloaded nvidia-cusolver-cu12
 Downloaded nvidia-cusparse-cu12
 Downloaded nvidia-cusparselt-cu12
 Downloaded nvidia-nccl-cu12
 Downloaded nvidia-cublas-cu12
 Downloaded nvidia-cudnn-cu12
 Downloaded torch
Prepared 81 packages in 33.02s
Installed 81 packages in 319ms
 + absl-py==2.3.1
 + alembic==1.17.2
 + annotated-types==0.7.0
 + antlr4-python3-runtime==4.9.3
 + certifi==2025.11.12
 + charset-normalizer==3.4.4
 + click==8.3.1
 + colorlog==6.10.1
 + contourpy==1.3.3
 + curval-research==0.1.0 (from file:///home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3)
 + cycler==0.12.1
 + filelock==3.20.1
 + fonttools==4.61.1
 + fsspec==2025.12.0
 + gitdb==4.0.12
 + gitpython==3.1.45
 + greenlet==3.3.0
 + grpcio==1.76.0
 + hydra-core==1.3.2
 + idna==3.11
 + jinja2==3.1.6
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + mako==1.3.10
 + markdown==3.10
 + markupsafe==3.0.3
 + matplotlib==3.10.8
 + mpmath==1.3.0
 + networkx==3.6.1
 + numpy==2.3.5
 + nvidia-cublas-cu12==12.8.4.1
 + nvidia-cuda-cupti-cu12==12.8.90
 + nvidia-cuda-nvrtc-cu12==12.8.93
 + nvidia-cuda-runtime-cu12==12.8.90
 + nvidia-cudnn-cu12==9.10.2.21
 + nvidia-cufft-cu12==11.3.3.83
 + nvidia-cufile-cu12==1.13.1.3
 + nvidia-curand-cu12==10.3.9.90
 + nvidia-cusolver-cu12==11.7.3.90
 + nvidia-cusparse-cu12==12.5.8.93
 + nvidia-cusparselt-cu12==0.7.1
 + nvidia-nccl-cu12==2.27.5
 + nvidia-nvjitlink-cu12==12.8.93
 + nvidia-nvshmem-cu12==3.3.20
 + nvidia-nvtx-cu12==12.8.90
 + omegaconf==2.3.0
 + optuna==4.6.0
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.0.0
 + platformdirs==4.5.1
 + protobuf==6.33.2
 + pydantic==2.12.5
 + pydantic-core==2.41.5
 + pyparsing==3.2.5
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.3
 + requests==2.32.5
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + seaborn==0.13.2
 + sentry-sdk==2.48.0
 + setuptools==80.9.0
 + six==1.17.0
 + smmap==5.0.2
 + sqlalchemy==2.0.45
 + sympy==1.14.0
 + tensorboard==2.20.0
 + tensorboard-data-server==0.7.2
 + threadpoolctl==3.6.0
 + torch==2.9.1
 + torchvision==0.24.1
 + tqdm==4.67.1
 + triton==3.5.1
 + typing-extensions==4.15.0
 + typing-inspection==0.4.2
 + tzdata==2025.3
 + urllib3==2.6.2
 + wandb==0.23.1
 + werkzeug==3.1.4
2025-12-18 11:24:12,659 - __main__ - INFO - ================================================================================
2025-12-18 11:24:12,659 - __main__ - INFO - Running Optuna optimization with 20 trials
2025-12-18 11:24:12,659 - __main__ - INFO - ================================================================================
[I 2025-12-18 11:24:12,660] A new study created in memory with name: no-name-87fe5c34-0ccd-48a4-a805-49264edd10c9
  0%|          | 0/20 [00:00<?, ?it/s]2025-12-18 11:24:12,665 - __main__ - INFO - Trainer initialized on device: cpu
2025-12-18 11:24:12,665 - __main__ - INFO - ================================================================================
2025-12-18 11:24:12,665 - __main__ - INFO - STARTING TRAINING
2025-12-18 11:24:12,665 - __main__ - INFO - ================================================================================
2025-12-18 11:24:12,665 - __main__ - INFO - Building model: ResNet-20
2025-12-18 11:24:12,674 - __main__ - INFO - Model parameters - Total: 272,474, Trainable: 272,474
2025-12-18 11:24:12,682 - __main__ - INFO - ✓ Model output shape verified: torch.Size([2, 10])
2025-12-18 11:24:12,683 - __main__ - INFO - Loading dataset: CIFAR-10

  0%|          | 0.00/170M [00:00<?, ?B/s][A
  0%|          | 32.8k/170M [00:00<10:22, 274kB/s][A
  0%|          | 229k/170M [00:00<02:47, 1.02MB/s][A
  1%|          | 885k/170M [00:00<00:57, 2.96MB/s][A
  1%|▏         | 2.52M/170M [00:00<00:22, 7.56MB/s][A
  2%|▏         | 4.23M/170M [00:00<00:15, 10.7MB/s][A
  4%|▎         | 6.06M/170M [00:00<00:12, 13.0MB/s][A
  5%|▍         | 8.00M/170M [00:00<00:12, 12.7MB/s][A
  8%|▊         | 13.8M/170M [00:00<00:06, 25.0MB/s][A
 10%|█         | 17.2M/170M [00:01<00:05, 27.5MB/s][A
 12%|█▏        | 20.2M/170M [00:01<00:06, 24.1MB/s][A
 13%|█▎        | 22.8M/170M [00:01<00:05, 24.7MB/s][A
 15%|█▍        | 25.5M/170M [00:01<00:06, 23.3MB/s][A
 16%|█▋        | 27.9M/170M [00:01<00:06, 23.3MB/s][A
 18%|█▊        | 30.5M/170M [00:01<00:05, 24.0MB/s][A
 19%|█▉        | 33.0M/170M [00:01<00:05, 22.9MB/s][A
 21%|██        | 35.8M/170M [00:01<00:05, 24.2MB/s][A
 22%|██▏       | 38.3M/170M [00:01<00:05, 23.6MB/s][A
 24%|██▍       | 41.1M/170M [00:02<00:05, 24.4MB/s][A
 26%|██▌       | 43.5M/170M [00:02<00:05, 23.7MB/s][A
 27%|██▋       | 46.0M/170M [00:02<00:05, 22.2MB/s][A
 28%|██▊       | 48.2M/170M [00:02<00:05, 20.5MB/s][A
 30%|██▉       | 50.3M/170M [00:02<00:05, 20.2MB/s][A
 31%|███       | 52.4M/170M [00:02<00:06, 19.1MB/s][A
 32%|███▏      | 54.4M/170M [00:02<00:06, 19.1MB/s][A
 33%|███▎      | 56.3M/170M [00:02<00:06, 19.0MB/s][A
 34%|███▍      | 58.2M/170M [00:02<00:06, 18.3MB/s][A
 35%|███▌      | 60.1M/170M [00:03<00:06, 17.7MB/s][A
 36%|███▋      | 62.0M/170M [00:03<00:06, 18.0MB/s][A
 37%|███▋      | 63.8M/170M [00:03<00:06, 17.7MB/s][A
 39%|███▊      | 65.9M/170M [00:03<00:05, 18.4MB/s][A
 40%|███▉      | 68.1M/170M [00:03<00:05, 19.5MB/s][A
 41%|████      | 70.3M/170M [00:03<00:04, 20.1MB/s][A
 42%|████▏     | 72.5M/170M [00:03<00:04, 20.5MB/s][A
 44%|████▍     | 74.7M/170M [00:03<00:04, 20.7MB/s][A
 45%|████▌     | 77.5M/170M [00:03<00:04, 22.6MB/s][A
 47%|████▋     | 79.8M/170M [00:04<00:04, 21.3MB/s][A
 49%|████▉     | 83.2M/170M [00:04<00:03, 24.7MB/s][A
 51%|█████▏    | 87.7M/170M [00:04<00:02, 30.3MB/s][A
 54%|█████▍    | 92.0M/170M [00:04<00:02, 34.0MB/s][A
 56%|█████▌    | 95.8M/170M [00:04<00:02, 35.1MB/s][A
 59%|█████▉    | 100M/170M [00:04<00:01, 37.7MB/s] [A
 61%|██████▏   | 104M/170M [00:04<00:01, 39.0MB/s][A
 64%|██████▎   | 108M/170M [00:04<00:01, 37.1MB/s][A
 66%|██████▌   | 112M/170M [00:04<00:01, 38.2MB/s][A
 68%|██████▊   | 117M/170M [00:04<00:01, 39.2MB/s][A
 71%|███████   | 121M/170M [00:05<00:01, 39.9MB/s][A
 74%|███████▍  | 126M/170M [00:05<00:01, 42.8MB/s][A
 76%|███████▋  | 130M/170M [00:05<00:00, 42.6MB/s][A
 79%|███████▉  | 134M/170M [00:05<00:00, 41.9MB/s][A
 81%|████████▏ | 139M/170M [00:05<00:00, 42.1MB/s][A
 84%|████████▍ | 143M/170M [00:05<00:00, 38.4MB/s][A
 87%|████████▋ | 148M/170M [00:05<00:00, 41.8MB/s][A
 89%|████████▉ | 152M/170M [00:05<00:00, 40.7MB/s][A
 92%|█████████▏| 157M/170M [00:05<00:00, 43.0MB/s][A
 95%|█████████▍| 162M/170M [00:06<00:00, 43.3MB/s][A
 98%|█████████▊| 167M/170M [00:06<00:00, 44.6MB/s][A100%|██████████| 170M/170M [00:06<00:00, 27.4MB/s]
2025-12-18 11:24:21,977 - __main__ - INFO - Train samples: 45000, Val samples: 5000, Test samples: 10000
2025-12-18 11:24:21,977 - __main__ - INFO - Train batches per epoch: 351
2025-12-18 11:24:21,979 - __main__ - INFO - ✓ Normalization stats validated - Mean: [0.4914 0.4822 0.4465], Std: [0.2023 0.1994 0.201 ]
                                        0%|          | 0/20 [00:09<?, ?it/s]                                        0%|          | 0/20 [00:09<?, ?it/s]  0%|          | 0/20 [00:09<?, ?it/s]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 656, in <module>
    best_val, best_params = run_optuna_optimization(cfg)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 627, in run_optuna_optimization
    study.optimize(
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 67, in _optimize
    _optimize_sequential(
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 164, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 262, in _run_trial
    raise func_err
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/study/_optimize.py", line 205, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 628, in <lambda>
    lambda trial: objective(trial, cfg),
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 603, in objective
    return trainer.train(trial)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 522, in train
    trial_params = self._suggest_optuna_params(trial)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/src/train.py", line 482, in _suggest_optuna_params
    params[param_name] = trial.suggest_float(
                         ^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/trial/_trial.py", line 162, in suggest_float
    distribution = FloatDistribution(low, high, log=log, step=step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/work/test-matsuzawa-20251218-3/test-matsuzawa-20251218-3/.venv/lib/python3.11/site-packages/optuna/distributions.py", line 149, in __init__
    raise ValueError(f"`low > 0` must hold for `log=True`, but got ({low=}, {high=}).")
ValueError: `low > 0` must hold for `log=True`, but got (low=0.0, high=0.1).
